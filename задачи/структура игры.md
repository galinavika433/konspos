### 1. Основные элементы игры:

#### 1.1. Игровое поле

- **Назначение:** Определяет границы игры, служит контейнером для всех игровых объектов.
- **Представление:** Чаще всего это двумерный массив (список списков) или матрица, где каждая ячейка имеет координаты (X, Y) и может хранить состояние (пусто, часть змейки, еда, стена).
- **Свойства:**
- `width` (ширина): Количество ячеек по горизонтали.
- `height` (высота): Количество ячеек по вертикали.
- `grid_cells`: Матрица, представляющая состояние каждой ячейки.
- `boundaries`: Могут быть явными (стены) или неявными (выход за пределы поля = проигрыш, или "телепортация" на противоположную сторону).

#### 1.2. Змейка 

- **Назначение:** Управляемый игроком объект, который движется по полю, ест еду и растет.
- **Представление:** Список координат (или объектов "сегмент"), где первый элемент списка - это голова змейки, а остальные - ее тело.
- **Свойства:**
- `segments`: Список объектов `(x, y)` или `Segment`.
- `head`: Координаты головы змейки.
- `direction`: Текущее направление движения (вверх, вниз, влево, вправо).
- `length`: Текущая длина змейки (количество сегментов).
- `growing`: Флаг, указывающий, должна ли змейка вырасти на следующем шаге (после поедания еды).

#### 1.3. Еда

- **Назначение:** Объект, который змейка должна съесть, чтобы расти и увеличивать счет.
- **Представление:** Одиночная координата `(x, y)`.
- **Свойства:**
- `position`: Координаты `(x, y)` на игровом поле.

#### 1.4. Счет 

- **Назначение:** Отслеживает прогресс игрока.
- **Представление:** Целочисленная переменная.
- **Свойства:**
- `current_score`: Текущее количество очков.
- **Действия:**
- `increment()`: Увеличивает счет при поедании еды.
- `reset()`: Обнуляет счет при начале новой игры.

#### 1.5. Состояние игры

- **Назначение:** Общее состояние игры, включая запуск, паузу, проигрыш.
- **Представление:** Переменная или перечисление (Enum).
- **Свойства:**
- `is_running`: Булево значение, `True` пока игра активна.
- `game_over`: Булево значение, `True` при проигрыше.
- `is_paused`: Булево значение, `True` если игра на паузе.

### 2. Логика движения змейки и взаимодействия с игровым полем:

#### 2.1. Основной игровой цикл 

Это сердце игры, которое постоянно повторяется, пока игра не закончится.

1. **Обработка ввода игрока (`handle_input()`):**

- Проверяет нажатия клавиш (стрелки или WASD).
- Меняет `snake.direction`, если нажата соответствующая клавиша.
- **Важно:** Запретить мгновенный поворот на 180 градусов (например, если змейка движется вправо, нельзя сразу повернуть влево).

1. **Обновление состояния игры (`update_game_state()`):**

- **Движение змейки (`snake.move()`):**
- Вычисляется новая позиция головы змейки на основе текущего `snake.direction`.
- Новая позиция головы добавляется в начало списка `snake.segments`.
- Если `snake.growing` равно `False`, то последний сегмент (хвост) удаляется из списка `snake.segments`. Это создает иллюзию движения.
- Если `snake.growing` было `True`, то хвост не удаляется, и змейка увеличивается в длину на один сегмент. После этого `snake.growing` сбрасывается в `False`.
- **Проверка столкновений (`check_collisions()`):**
- **Со стенами:** Проверяется, вышла ли `snake.head` за пределы `game_board.width` или `game_board.height`.
- _Вариант 1 (проигрыш):_ Если вышла, то `game_over = True`.
- _Вариант 2 (телепортация):_ Если вышла, `snake.head` переносится на противоположную сторону поля.
- **С собой:** Проверяется, совпадает ли `snake.head` с какой-либо частью `snake.segments` (кроме самой головы). Если совпадает, то `game_over = True`.
- **С едой:** Проверяется, совпадает ли `snake.head` с `food.position`. Если совпадает:
- `score.increment()`.
- `snake.growing = True`.
- `food.spawn_random()` (генерация новой еды).

1. **Отрисовка игры (`render_game()`):**

- Очищает экран.
- Отрисовывает `game_board` (границы, пустые ячейки).
- Отрисовывает `snake.segments` (голову и тело).
- Отрисовывает `food.position`.
- Отображает `score.current_score`.
- Если `game_over = True`, выводит сообщение "Game Over".

1. **Задержка/Скорость игры (`wait()`):**

- Вводит небольшую задержку, чтобы игра не работала слишком быстро. Это контролирует скорость движения змейки.

#### 2.2. Генерация еды (`food.spawn_random()`)

- Генерирует случайные координаты `(x, y)` в пределах `game_board.width` и `game_board.height`.
- **Важно:** Проверяет, что сгенерированная позиция не занята ни одним сегментом змейки. Если занята, повторяет генерацию до тех пор, пока не найдет свободное место.

#### 2.3. Начальная инициализация (`initialize_game()`)

- Создает `game_board` с заданными размерами.
- Инициализирует `snake` (например, в центре поля, с начальной длиной и направлением).
- Генерирует первую `food` на случайной позиции.
- Сбрасывает `score` до 0.
- Устанавливает `game_over = False` и `is_running = True`.

---

### Структура классов (ООП подход):

Можно представить это следующим образом:

- **`Game` Class:**
- `__init__`: Инициализация игрового поля, змейки, еды, счета, состояния игры.
- `run`: Основной игровой цикл.
- `handle_input`: Обработка ввода.
- `update`: Обновление логики.
- `draw`: Отрисовка.
- `reset_game`: Сброс игры для нового запуска.
- **`Snake` Class:**
- `__init__`: Инициализация сегментов, направления, длины.
- `move`: Логика перемещения.
- `change_direction`: Изменение направления.
- `get_head_position`: Получение позиции головы.
- `get_body_positions`: Получение позиций тела (для проверки столкновений).
- `check_collision_with_self`: Проверка столкновения с телом.
- `grow`: Установка флага роста.
- **`Food` Class:**
- `__init__`: Инициализация позиции.
- `spawn_random`: Генерация новой позиции (требуется доступ к `Game_board` и `Snake` для проверки свободных ячеек).
- **`GameBoard` Class:**
- `__init__`: Инициализация размеров поля.
- `is_within_bounds`: Проверка, находится ли координата в пределах поля.
- `get_cell_state`: Получение состояния конкретной ячейки (для отрисовки).